!function(){var e,t,i,n,o,r,s,a,u,h,l,c,p,d,f,y,m,v,g,S,w,x,k,b,E,_,O,F=function(e){var t=new F.Index;return t.pipeline.add(F.trimmer,F.stopWordFilter,F.stemmer),e&&e.call(t,t),t};F.version="0.5.7",F.utils={},F.utils.warn=(e=this,function(t){e.console&&console.warn&&console.warn(t)}),F.EventEmitter=function(){this.events={}},F.EventEmitter.prototype.addListener=function(){var e=Array.prototype.slice.call(arguments),t=e.pop(),i=e;if("function"!=typeof t)throw new TypeError("last argument must be a function");i.forEach(function(e){this.hasHandler(e)||(this.events[e]=[]),this.events[e].push(t)},this)},F.EventEmitter.prototype.removeListener=function(e,t){if(this.hasHandler(e)){var i=this.events[e].indexOf(t);this.events[e].splice(i,1),this.events[e].length||delete this.events[e]}},F.EventEmitter.prototype.emit=function(e){if(this.hasHandler(e)){var t=Array.prototype.slice.call(arguments,1);this.events[e].forEach(function(e){e.apply(void 0,t)})}},F.EventEmitter.prototype.hasHandler=function(e){return e in this.events},F.tokenizer=function(e){if(!arguments.length||null==e||void 0==e)return[];if(Array.isArray(e))return e.map(function(e){return e.toLowerCase()});for(var t=e.toString().replace(/^\s+/,""),i=t.length-1;i>=0;i--)if(/\S/.test(t.charAt(i))){t=t.substring(0,i+1);break}return t.split(/(?:\s+|\-)/).filter(function(e){return!!e}).map(function(e){return e.toLowerCase()})},F.Pipeline=function(){this._stack=[]},F.Pipeline.registeredFunctions={},F.Pipeline.registerFunction=function(e,t){t in this.registeredFunctions&&F.utils.warn("Overwriting existing registered function: "+t),e.label=t,F.Pipeline.registeredFunctions[e.label]=e},F.Pipeline.warnIfFunctionNotRegistered=function(e){e.label&&e.label in this.registeredFunctions||F.utils.warn("Function is not registered with pipeline. This may cause problems when serialising the index.\n",e)},F.Pipeline.load=function(e){var t=new F.Pipeline;return e.forEach(function(e){var i=F.Pipeline.registeredFunctions[e];if(!i)throw new Error("Cannot load un-registered function: "+e);t.add(i)}),t},F.Pipeline.prototype.add=function(){Array.prototype.slice.call(arguments).forEach(function(e){F.Pipeline.warnIfFunctionNotRegistered(e),this._stack.push(e)},this)},F.Pipeline.prototype.after=function(e,t){F.Pipeline.warnIfFunctionNotRegistered(t);var i=this._stack.indexOf(e)+1;this._stack.splice(i,0,t)},F.Pipeline.prototype.before=function(e,t){F.Pipeline.warnIfFunctionNotRegistered(t);var i=this._stack.indexOf(e);this._stack.splice(i,0,t)},F.Pipeline.prototype.remove=function(e){var t=this._stack.indexOf(e);this._stack.splice(t,1)},F.Pipeline.prototype.run=function(e){for(var t=[],i=e.length,n=this._stack.length,o=0;o<i;o++){for(var r=e[o],s=0;s<n&&void 0!==(r=this._stack[s](r,o,e));s++);void 0!==r&&t.push(r)}return t},F.Pipeline.prototype.reset=function(){this._stack=[]},F.Pipeline.prototype.toJSON=function(){return this._stack.map(function(e){return F.Pipeline.warnIfFunctionNotRegistered(e),e.label})},F.Vector=function(){this._magnitude=null,this.list=void 0,this.length=0},F.Vector.Node=function(e,t,i){this.idx=e,this.val=t,this.next=i},F.Vector.prototype.insert=function(e,t){var i=this.list;if(!i)return this.list=new F.Vector.Node(e,t,i),this.length++;for(var n=i,o=i.next;void 0!=o;){if(e<o.idx)return n.next=new F.Vector.Node(e,t,o),this.length++;n=o,o=o.next}return n.next=new F.Vector.Node(e,t,o),this.length++},F.Vector.prototype.magnitude=function(){if(this._magniture)return this._magnitude;for(var e,t=this.list,i=0;t;)i+=(e=t.val)*e,t=t.next;return this._magnitude=Math.sqrt(i)},F.Vector.prototype.dot=function(e){for(var t=this.list,i=e.list,n=0;t&&i;)t.idx<i.idx?t=t.next:t.idx>i.idx?i=i.next:(n+=t.val*i.val,t=t.next,i=i.next);return n},F.Vector.prototype.similarity=function(e){return this.dot(e)/(this.magnitude()*e.magnitude())},F.SortedSet=function(){this.length=0,this.elements=[]},F.SortedSet.load=function(e){var t=new this;return t.elements=e,t.length=e.length,t},F.SortedSet.prototype.add=function(){Array.prototype.slice.call(arguments).forEach(function(e){~this.indexOf(e)||this.elements.splice(this.locationFor(e),0,e)},this),this.length=this.elements.length},F.SortedSet.prototype.toArray=function(){return this.elements.slice()},F.SortedSet.prototype.map=function(e,t){return this.elements.map(e,t)},F.SortedSet.prototype.forEach=function(e,t){return this.elements.forEach(e,t)},F.SortedSet.prototype.indexOf=function(e,t,i){t=t||0;var n=(i=i||this.elements.length)-t,o=t+Math.floor(n/2),r=this.elements[o];return n<=1?r===e?o:-1:r<e?this.indexOf(e,o,i):r>e?this.indexOf(e,t,o):r===e?o:void 0},F.SortedSet.prototype.locationFor=function(e,t,i){t=t||0;var n=(i=i||this.elements.length)-t,o=t+Math.floor(n/2),r=this.elements[o];if(n<=1){if(r>e)return o;if(r<e)return o+1}return r<e?this.locationFor(e,o,i):r>e?this.locationFor(e,t,o):void 0},F.SortedSet.prototype.intersect=function(e){for(var t=new F.SortedSet,i=0,n=0,o=this.length,r=e.length,s=this.elements,a=e.elements;!(i>o-1||n>r-1);)s[i]!==a[n]?s[i]<a[n]?i++:s[i]>a[n]&&n++:(t.add(s[i]),i++,n++);return t},F.SortedSet.prototype.clone=function(){var e=new F.SortedSet;return e.elements=this.toArray(),e.length=e.elements.length,e},F.SortedSet.prototype.union=function(e){var t,i,n;return this.length>=e.length?(t=this,i=e):(t=e,i=this),(n=t.clone()).add.apply(n,i.toArray()),n},F.SortedSet.prototype.toJSON=function(){return this.toArray()},F.Index=function(){this._fields=[],this._ref="id",this.pipeline=new F.Pipeline,this.documentStore=new F.Store,this.tokenStore=new F.TokenStore,this.corpusTokens=new F.SortedSet,this.eventEmitter=new F.EventEmitter,this._idfCache={},this.on("add","remove","update",function(){this._idfCache={}}.bind(this))},F.Index.prototype.on=function(){var e=Array.prototype.slice.call(arguments);return this.eventEmitter.addListener.apply(this.eventEmitter,e)},F.Index.prototype.off=function(e,t){return this.eventEmitter.removeListener(e,t)},F.Index.load=function(e){e.version!==F.version&&F.utils.warn("version mismatch: current "+F.version+" importing "+e.version);var t=new this;return t._fields=e.fields,t._ref=e.ref,t.documentStore=F.Store.load(e.documentStore),t.tokenStore=F.TokenStore.load(e.tokenStore),t.corpusTokens=F.SortedSet.load(e.corpusTokens),t.pipeline=F.Pipeline.load(e.pipeline),t},F.Index.prototype.field=function(e,t){var i={name:e,boost:(t=t||{}).boost||1};return this._fields.push(i),this},F.Index.prototype.ref=function(e){return this._ref=e,this},F.Index.prototype.add=function(e,t){var i={},n=new F.SortedSet,o=e[this._ref];t=void 0===t||t;this._fields.forEach(function(t){var o=this.pipeline.run(F.tokenizer(e[t.name]));i[t.name]=o,F.SortedSet.prototype.add.apply(n,o)},this),this.documentStore.set(o,n),F.SortedSet.prototype.add.apply(this.corpusTokens,n.toArray());for(var r=0;r<n.length;r++){var s=n.elements[r],a=this._fields.reduce(function(e,t){var n=i[t.name].length;return n?e+i[t.name].filter(function(e){return e===s}).length/n*t.boost:e},0);this.tokenStore.add(s,{ref:o,tf:a})}t&&this.eventEmitter.emit("add",e,this)},F.Index.prototype.remove=function(e,t){var i=e[this._ref];t=void 0===t||t;if(this.documentStore.has(i)){var n=this.documentStore.get(i);this.documentStore.remove(i),n.forEach(function(e){this.tokenStore.remove(e,i)},this),t&&this.eventEmitter.emit("remove",e,this)}},F.Index.prototype.update=function(e,t){t=void 0===t||t;this.remove(e,!1),this.add(e,!1),t&&this.eventEmitter.emit("update",e,this)},F.Index.prototype.idf=function(e){var t="@"+e;if(Object.prototype.hasOwnProperty.call(this._idfCache,t))return this._idfCache[t];var i=this.tokenStore.count(e),n=1;return i>0&&(n=1+Math.log(this.tokenStore.length/i)),this._idfCache[t]=n},F.Index.prototype.search=function(e){var t=this.pipeline.run(F.tokenizer(e)),i=new F.Vector,n=[],o=this._fields.reduce(function(e,t){return e+t.boost},0);return t.some(function(e){return this.tokenStore.has(e)},this)?(t.forEach(function(e,t,r){var s=1/r.length*this._fields.length*o,a=this,u=this.tokenStore.expand(e).reduce(function(t,n){var o=a.corpusTokens.indexOf(n),r=a.idf(n),u=1,h=new F.SortedSet;if(n!==e){var l=Math.max(3,n.length-e.length);u=1/Math.log(l)}return o>-1&&i.insert(o,s*r*u),Object.keys(a.tokenStore.get(n)).forEach(function(e){h.add(e)}),t.union(h)},new F.SortedSet);n.push(u)},this),n.reduce(function(e,t){return e.intersect(t)}).map(function(e){return{ref:e,score:i.similarity(this.documentVector(e))}},this).sort(function(e,t){return t.score-e.score})):[]},F.Index.prototype.documentVector=function(e){for(var t=this.documentStore.get(e),i=t.length,n=new F.Vector,o=0;o<i;o++){var r=t.elements[o],s=this.tokenStore.get(r)[e].tf,a=this.idf(r);n.insert(this.corpusTokens.indexOf(r),s*a)}return n},F.Index.prototype.toJSON=function(){return{version:F.version,fields:this._fields,ref:this._ref,documentStore:this.documentStore.toJSON(),tokenStore:this.tokenStore.toJSON(),corpusTokens:this.corpusTokens.toJSON(),pipeline:this.pipeline.toJSON()}},F.Index.prototype.use=function(e){var t=Array.prototype.slice.call(arguments,1);t.unshift(this),e.apply(this,t)},F.Store=function(){this.store={},this.length=0},F.Store.load=function(e){var t=new this;return t.length=e.length,t.store=Object.keys(e.store).reduce(function(t,i){return t[i]=F.SortedSet.load(e.store[i]),t},{}),t},F.Store.prototype.set=function(e,t){this.has(e)||this.length++,this.store[e]=t},F.Store.prototype.get=function(e){return this.store[e]},F.Store.prototype.has=function(e){return e in this.store},F.Store.prototype.remove=function(e){this.has(e)&&(delete this.store[e],this.length--)},F.Store.prototype.toJSON=function(){return{store:this.store,length:this.length}},F.stemmer=(t={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},i={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},n="[aeiouy]",o="[^aeiou][^aeiouy]*",r=new RegExp("^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*"),s=new RegExp("^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*"),a=new RegExp("^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$"),u=new RegExp("^([^aeiou][^aeiouy]*)?[aeiouy]"),h=/^(.+?)(ss|i)es$/,l=/^(.+?)([^s])s$/,c=/^(.+?)eed$/,p=/^(.+?)(ed|ing)$/,d=/.$/,f=/(at|bl|iz)$/,y=new RegExp("([^aeiouylsz])\\1$"),m=new RegExp("^"+o+n+"[^aeiouwxy]$"),v=/^(.+?[^aeiou])y$/,g=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,S=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,w=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,x=/^(.+?)(s|t)(ion)$/,k=/^(.+?)e$/,b=/ll$/,E=new RegExp("^"+o+n+"[^aeiouwxy]$"),function(e){var n,o,_,O,F,P,T;if(e.length<3)return e;if("y"==(_=e.substr(0,1))&&(e=_.toUpperCase()+e.substr(1)),F=l,(O=h).test(e)?e=e.replace(O,"$1$2"):F.test(e)&&(e=e.replace(F,"$1$2")),F=p,(O=c).test(e)){var $=O.exec(e);(O=r).test($[1])&&(O=d,e=e.replace(O,""))}else F.test(e)&&(n=($=F.exec(e))[1],(F=u).test(n)&&(P=y,T=m,(F=f).test(e=n)?e+="e":P.test(e)?(O=d,e=e.replace(O,"")):T.test(e)&&(e+="e")));return(O=v).test(e)&&(e=(n=($=O.exec(e))[1])+"i"),(O=g).test(e)&&(n=($=O.exec(e))[1],o=$[2],(O=r).test(n)&&(e=n+t[o])),(O=S).test(e)&&(n=($=O.exec(e))[1],o=$[2],(O=r).test(n)&&(e=n+i[o])),F=x,(O=w).test(e)?(n=($=O.exec(e))[1],(O=s).test(n)&&(e=n)):F.test(e)&&(n=($=F.exec(e))[1]+$[2],(F=s).test(n)&&(e=n)),(O=k).test(e)&&(n=($=O.exec(e))[1],F=a,P=E,((O=s).test(n)||F.test(n)&&!P.test(n))&&(e=n)),F=s,(O=b).test(e)&&F.test(e)&&(O=d,e=e.replace(O,"")),"y"==_&&(e=_.toLowerCase()+e.substr(1)),e}),F.Pipeline.registerFunction(F.stemmer,"stemmer"),F.stopWordFilter=function(e){if(-1===F.stopWordFilter.stopWords.indexOf(e))return e},F.stopWordFilter.stopWords=new F.SortedSet,F.stopWordFilter.stopWords.length=119,F.stopWordFilter.stopWords.elements=["","a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"],F.Pipeline.registerFunction(F.stopWordFilter,"stopWordFilter"),F.trimmer=function(e){return e.replace(/^\W+/,"").replace(/\W+$/,"")},F.Pipeline.registerFunction(F.trimmer,"trimmer"),F.TokenStore=function(){this.root={docs:{}},this.length=0},F.TokenStore.load=function(e){var t=new this;return t.root=e.root,t.length=e.length,t},F.TokenStore.prototype.add=function(e,t,i){i=i||this.root;var n=e[0],o=e.slice(1);return n in i||(i[n]={docs:{}}),0===o.length?(i[n].docs[t.ref]=t,void(this.length+=1)):this.add(o,t,i[n])},F.TokenStore.prototype.has=function(e){if(!e)return!1;for(var t=this.root,i=0;i<e.length;i++){if(!t[e[i]])return!1;t=t[e[i]]}return!0},F.TokenStore.prototype.getNode=function(e){if(!e)return{};for(var t=this.root,i=0;i<e.length;i++){if(!t[e[i]])return{};t=t[e[i]]}return t},F.TokenStore.prototype.get=function(e,t){return this.getNode(e,t).docs||{}},F.TokenStore.prototype.count=function(e,t){return Object.keys(this.get(e,t)).length},F.TokenStore.prototype.remove=function(e,t){if(e){for(var i=this.root,n=0;n<e.length;n++){if(!(e[n]in i))return;i=i[e[n]]}delete i.docs[t]}},F.TokenStore.prototype.expand=function(e,t){var i=this.getNode(e),n=i.docs||{};t=t||[];return Object.keys(n).length&&t.push(e),Object.keys(i).forEach(function(i){"docs"!==i&&t.concat(this.expand(e+i,t))},this),t},F.TokenStore.prototype.toJSON=function(){return{root:this.root,length:this.length}},_=this,O=function(){return F},"function"==typeof define&&define.amd?define(O):"object"==typeof exports?module.exports=O():_.lunr=O()}();